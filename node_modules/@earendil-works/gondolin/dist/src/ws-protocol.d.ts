import type { SandboxPolicy } from "./policy";
export type { SandboxPolicy, SandboxPolicyRule } from "./policy";
export type ExecCommandMessage = {
    type: "exec";
    id: number;
    cmd: string;
    argv?: string[];
    env?: string[];
    cwd?: string;
    stdin?: boolean;
    pty?: boolean;
};
export type StdinCommandMessage = {
    type: "stdin";
    id: number;
    data?: string;
    eof?: boolean;
};
export type PtyResizeCommandMessage = {
    type: "pty_resize";
    id: number;
    rows: number;
    cols: number;
};
export type LifecycleCommandMessage = {
    type: "lifecycle";
    action: "restart" | "shutdown";
};
export type BootCommandMessage = {
    type: "boot";
    fuseMount?: string;
    fuseBinds?: string[];
};
export type PolicyCommandMessage = {
    type: "policy";
    policy: SandboxPolicy;
};
export type ClientMessage = BootCommandMessage | ExecCommandMessage | StdinCommandMessage | PtyResizeCommandMessage | LifecycleCommandMessage | PolicyCommandMessage;
export type ExecResponseMessage = {
    type: "exec_response";
    id: number;
    exit_code: number;
    signal?: number;
};
export type ErrorMessage = {
    type: "error";
    id?: number;
    code: string;
    message: string;
};
export type StatusMessage = {
    type: "status";
    state: "starting" | "running" | "stopped";
};
export type ServerMessage = ExecResponseMessage | ErrorMessage | StatusMessage;
export type OutputStream = "stdout" | "stderr";
export declare const OUTPUT_HEADER_BYTES = 5;
export declare function encodeOutputFrame(id: number, stream: OutputStream, data: Buffer): Buffer;
export declare function decodeOutputFrame(frame: Buffer): {
    id: number;
    stream: OutputStream;
    data: Buffer;
};
//# sourceMappingURL=ws-protocol.d.ts.map